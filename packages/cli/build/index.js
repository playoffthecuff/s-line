#!/usr/bin/env node
// @bun
import{Command as i}from"commander";import a from"inquirer";import s from"path";import p from"fs/promises";import{fileURLToPath as l}from"url";import{promisify as m}from"util";import{existsSync as r,readFileSync as d}from"fs";import{exec as f}from"child_process";var g={bun:"bun.lock",pnpm:"pnpm-lock.yaml",yarn:"yarn.lock",npm:"package-lock.json"},u=()=>Object.entries(g).find(([n,o])=>r(o))?.[0]??"npm",y=m(f);function j(n){let o=process.cwd(),t=s.join(o,"package.json");if(!r(t))return!1;let e=JSON.parse(d(t,"utf8"));return Boolean(e.dependencies?.[n]||e.devDependencies?.[n]||e.peerDependencies?.[n])}var k=async(n)=>{let o=u(),t={bun:`bun add ${n.join(" ")}`,pnpm:`pnpm add ${n.join(" ")}`,yarn:`yarn add ${n.join(" ")}`,npm:`npm install ${n.join(" ")}`}[o];if(console.log(`\uD83D\uDCE6 Installing ${n.join(", ")} using ${o}...`),t)await y(t)},w=async(n)=>{let o=n.filter((t)=>!j(t));if(o.length===0){console.log(`\u2714 All deps already installed: ${n.join(", ")}`);return}console.log(`\uD83D\uDCE6 Installing ${o.join(", ")}`);try{await k(o)}catch(t){console.error("\u274C Install error:",t)}},c=new i,$=l(import.meta.url),h=s.dirname($);c.command("add [name]").description("Add a component to your project").action(async(n)=>{if(!n){let{component:e}=await a.prompt([{type:"input",name:"component",message:"Component name:"}]);n=e}let o=s.join(h,"../templates",n),t=s.join(process.cwd(),"src","components",n);await p.cp(o,t,{recursive:!0}),await w(["class-variance-authority"]),console.log(`\u2705 Added ${n}`)});c.parse();export{j as isDependencyInstalled,w as installDepsIfMissing,k as installDeps,u as detectPackageManager};
